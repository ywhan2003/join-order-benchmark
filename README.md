# Join Order Benchmark

This package contains the **Join Order Benchmark** (JOB) queries from:  
"How Good Are Query Optimizers, Really?"  
by Viktor Leis, Andrey Gubichev, Atans Mirchev, Peter Boncz, Alfons Kemper, Thomas Neumann  
PVLDB Volume 9, No. 3, 2015  
[http://www.vldb.org/pvldb/vol9/p204-leis.pdf](http://www.vldb.org/pvldb/vol9/p204-leis.pdf)

This repository is not maintained by the original authors of the Join Order Benchmark. The purpose is to ease the distribution of Join Order Benchmark queries (e.g., as a git submodule).

Please be aware that the queries assume the data set from the original paper (see below for the CWI link).
The queries might yield unexpected results when used on the "Frozen Data Set" generated by the step-by-step instructions below.

### IMDB Data Set
The CSV files used in the paper, can be found at 
[https://event.cwi.nl/da/job/imdb.tgz](https://event.cwi.nl/da/job/imdb.tgz)

The license and links to the current version IMDB data set can be
found at 
[http://www.imdb.com/interfaces](http://www.imdb.com/interfaces)

### Step-by-step instructions
1. download `*gz` files (unpacking not necessary)

  ```sh
  wget https://event.cwi.nl/da/job/imdb.tgz
  ```

2. unzip the file

  ```sh
  tar -xzvf imdb.tgz -C imdb
  ```
  
3. create PostgreSQL database (e.g., name imdbload):

  ```sh
  createdb imdbload
  ```

Now you should have a PostgreSQL database named `imdbload` with the
imdb data. Note that this database has some secondary indexes (but not
on all foreign key attributes). You can export all tables to CSV:

Suppose that you have downloaded the `imdb.tgz` with the path `/home/ubuntu/imdb`, 
you can use the following instructions to load the data.
```sql
\i PATH/join-order-benchmark/schema.sql;
\copy aka_name from /home/ubuntu/imdb/aka_name.csv with delimiter as ',' csv quote '"' escape as '\';
\copy aka_title from /home/ubuntu/imdb/aka_title.csv with delimiter as ',' csv quote '"' escape as '\';
\copy cast_info from /home/ubuntu/imdb/cast_info.csv with delimiter as ',' csv quote '"' escape as '\';
\copy char_name from /home/ubuntu/imdb/char_name.csv with delimiter as ',' csv quote '"' escape as '\';
\copy comp_cast_type from /home/ubuntu/imdb/comp_cast_type.csv with delimiter as ',' csv quote '"' escape as '\';
\copy company_name from /home/ubuntu/imdb/company_name.csv with delimiter as ',' csv quote '"' escape as '\';
\copy company_type from /home/ubuntu/imdb/company_type.csv with delimiter as ',' csv quote '"' escape as '\';
\copy complete_cast from /home/ubuntu/imdb/complete_cast.csv with delimiter as ',' csv quote '"' escape as '\';
\copy info_type from /home/ubuntu/imdb/info_type.csv with delimiter as ',' csv quote '"' escape as '\';
\copy keyword from /home/ubuntu/imdb/keyword.csv with delimiter as ',' csv quote '"' escape as '\';
\copy kind_type from /home/ubuntu/imdb/kind_type.csv with delimiter as ',' csv quote '"' escape as '\';
\copy link_type from /home/ubuntu/imdb/link_type.csv with delimiter as ',' csv quote '"' escape as '\';
\copy movie_companies from /home/ubuntu/imdb/movie_companies.csv with delimiter as ',' csv quote '"' escape as '\';
\copy movie_info_idx from /home/ubuntu/imdb/movie_info_idx.csv with delimiter as ',' csv quote '"' escape as '\';
\copy movie_info from /home/ubuntu/imdb/movie_info.csv with delimiter as ',' csv quote '"' escape as '\';
\copy movie_keyword from /home/ubuntu/imdb/movie_keyword.csv with delimiter as ',' csv quote '"' escape as '\';
\copy movie_link from /home/ubuntu/imdb/movie_link.csv with delimiter as ',' csv quote '"' escape as '\';
\copy name from /home/ubuntu/imdb/name.csv with delimiter as ',' csv quote '"' escape as '\';
\copy person_info from /home/ubuntu/imdb/person_info.csv with delimiter as ',' csv quote '"' escape as '\';
\copy role_type from /home/ubuntu/imdb/role_type.csv with delimiter as ',' csv quote '"' escape as '\';
\copy title from /home/ubuntu/imdb/title.csv with delimiter as ',' csv quote '"' escape as '\';
```

To import the CSV files to another database, create all tables (see
`schema.sql` and optionally `fkindexes.sql`) and run the same copy as
above statements but replace the keyword "to" by "from".
